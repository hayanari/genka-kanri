# 入札スケジュール機能 仕様書

## 概要

入札スケジュール一覧ページを新設し、**落札**または**当社に受注がほぼ決まっている**案件を、案件一覧ページにワンクリックで追加できるようにする。

---

## 業務フロー

```
入札スケジュール登録
       ↓
  入札日を迎える
       ↓
  結果を更新（落札 / 失札 / 当社受注見込み）
       ↓
  [落札] or [当社受注見込み] の場合
       ↓
  「案件一覧に追加」ボタンで案件化
       ↓
  案件一覧に出現 → 通常の原価管理へ
```

---

## 画面構成

### 1. 入札スケジュール一覧ページ

| 項目 | 内容 |
|------|------|
| ナビ | サイドバーに「入札スケジュール」を追加 |
| 一覧表示 | 案件名、発注者、予定金額、入札日、ステータス |
| 操作 | 新規追加、編集、削除、案件一覧に追加（条件付き） |
| 検索・絞込 | キーワード検索、ステータス絞り込み、日付ソート |

### 2. ステータス定義

| ステータス | ラベル | 案件一覧追加 |
|-----------|--------|-------------|
| `scheduled` | 入札予定 | × |
| `won` | 落札 | ◎ |
| `lost` | 失札 | × |
| `expected` | 当社受注見込み | ◎ |

※「落札」「当社受注見込み」のときのみ「案件一覧に追加」ボタンを表示

### 3. 案件一覧への追加

- ボタン押下で、入札スケジュールの情報をもとに **新規案件** を自動作成
- 初期ステータス: `ordered`（受注済）
- 契約金額・顧客名・区分などは入札スケジュールから引き継ぐ
- 追加後は入札スケジュールに「案件ID」を紐づけ、二重追加を防止

---

## データ構造

### 入札スケジュール (BidSchedule)

```ts
interface BidSchedule {
  id: string;
  name: string;           // 案件名
  client: string;         // 発注者
  category: "工事" | "業務";
  estimatedAmount: number; // 予定金額（概算）
  bidDate: string;        // 入札日 YYYY-MM-DD
  status: "scheduled" | "won" | "lost" | "expected";
  notes?: string;
  projectId?: string;     // 案件一覧に追加済みの場合の案件ID
}
```

### ストレージ

- 既存の `genka_kanri_data` の `data` JSONB に `bidSchedules: BidSchedule[]` を追加
- 後方互換: `bidSchedules` が無い場合は空配列として扱う

---

## UI/UX

- 既存の案件一覧・ダッシュボードと同様のデザイン（ダークテーマ）
- 入札日が近い順でデフォルトソート
- 「案件一覧に追加」は目立つボタンで表示

---

## 備考

- 入札スケジュールから案件化した項目は、通常の新規案件登録と同等の扱い
- 必要に応じて案件詳細で金額・工期などを後から修正可能
